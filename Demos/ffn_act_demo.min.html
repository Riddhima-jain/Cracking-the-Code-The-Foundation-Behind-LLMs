<!doctypehtml><html lang="en"><meta charset="utf-8"><title>Gossip Layer + Activation (Unified Notation)</title><meta name="viewport"content="width=device-width,initial-scale=1"><style>:root{--bg:#f8fafc;--panel:#ffffff;--text:#323130;--muted:#605e5c;--blue:#a4cafe;--pink:#fca5a5;--gold:#86efac;--bias:#c4b5fd;--grid:#f1f5f9;--biasEdge:#c4b5fd}*{box-sizing:border-box;margin:0;padding:0}body{background:var(--bg);color:var(--text);font:14px/1.35 system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial;padding:18px;display:flex;flex-wrap:wrap;gap:18px}.panel{flex:1 1 560px;background:var(--panel);border:1px solid #d8dde4;border-radius:16px;padding:14px 18px 18px;box-shadow:0 4px 10px rgba(0,0,0,.04);display:flex;flex-direction:column;min-width:440px}h2{margin:0 0 10px;font-size:17px;font-weight:600;letter-spacing:.4px}.controls{display:flex;gap:14px;align-items:center;flex-wrap:wrap;margin:4px 0 10px}.controls label{display:flex;gap:6px;align-items:center;font-size:12px}input[type=range]{accent-color:var(--blue)}.badge{font-size:12px;color:var(--muted)}.pill{padding:.38rem .65rem;background:#eef3fa;border:1px solid #d8dde4;border-radius:999px;font-size:12px;color:#1e242c}.legend{display:flex;gap:14px;font-size:11px;color:var(--muted);flex-wrap:wrap;margin:2px 0 8px}.legend span{display:inline-flex;align-items:center;gap:5px}.sw{width:14px;height:14px;border-radius:50%;outline:1px solid #222}.sw.in{background:var(--blue)}.sw.hid{background:var(--pink)}.sw.out{background:var(--gold)}.sw.bias{background:var(--bias)}.sw.pos{background:#86efac;border-radius:3px;width:18px;height:6px}.sw.neg{background:#fca5a5;border-radius:3px;width:18px;height:6px}.sw.w{background:linear-gradient(90deg,#86efac,#fca5a5);border-radius:3px;width:26px;height:8px}svg{width:100%;display:block;font-family:inherit}#net{height:400px}.node{stroke:#222;stroke-width:1.05;filter:drop-shadow(0 0 3px rgba(0,0,0,.18)) drop-shadow(0 2px 6px rgba(0,0,0,.12));transition:fill-opacity .35s}.n-in{fill:var(--blue)}.n-hid{fill:var(--pink)}.n-out{fill:var(--gold)}.n-bias{fill:var(--bias)}.edge{stroke-linecap:round;stroke-linejoin:round;fill:none;vector-effect:non-scaling-stroke;opacity:.95}.edge.pos{stroke:var(--gold)}.edge.neg{stroke:var(--blue)}.edge.bias{stroke:var(--biasEdge);stroke-dasharray:5 4}.edge[data-mag=lg]{stroke-width:3.1}.edge[data-mag=md]{stroke-width:2.1}.edge[data-mag=sm]{stroke-width:1.35;opacity:.85}.edge-label{font-size:10.5px;font-weight:600;fill:#16202a;paint-order:stroke;stroke:#fff;stroke-width:5px;pointer-events:none;opacity:.92}.edge-label.hidden{display:none}.label{fill:#14202b;font-size:12px;font-weight:500;pointer-events:none;paint-order:stroke;stroke:#fff;stroke-width:4px}.sum{fill:#10171f;font-size:13px;font-weight:600;pointer-events:none;paint-order:stroke;stroke:#fff;stroke-width:4px}.tiny{fill:#324252;font-size:11px;pointer-events:none;paint-order:stroke;stroke:#fff;stroke-width:4px;font-weight:500}.formulas{font:12px/1.34 ui-monospace,monospace;color:#1b2733;background:#f0f5fa;border:1px solid #d3dae2;border-radius:10px;padding:8px 10px;margin:6px 0 4px;max-width:720px;white-space:pre;overflow-x:auto}.caption{color:var(--muted);margin-top:6px;font-size:12px;line-height:1.26;max-width:720px}#plot{height:420px}.grid{stroke:var(--grid);stroke-width:.8;stroke-dasharray:3 6}.axis{stroke:#9aa2b0;stroke-width:1.05}.curve{fill:none;stroke:#60a5fa;stroke-width:2.6}.dot{fill:#f87171;stroke:#00000040;stroke-width:1.05}.projx{stroke:#94a3b8;stroke-dasharray:4 6;opacity:.75}.projy{stroke:#94a3b8;stroke-dasharray:4 6;opacity:.75}.tickLbl{fill:#5b6474;font-size:11px}.readout{display:flex;gap:16px;flex-wrap:wrap;margin:4px 0 6px;color:var(--muted);font:12.5px/1.25 ui-monospace,monospace}.readout b{color:#101820;font-weight:600}.viz{flex:1;display:flex;flex-direction:column;margin-top:4px;background:#f8fafd;border:1px solid #d8dde4;border-radius:12px;padding:8px 10px 10px}.ax-slider-row{display:flex;align-items:center;gap:12px;margin:4px 0 8px}.ax-slider-row input[type=range]{flex:1}.chk,select{background:#eef3fa;border:1px solid #cfd6de;color:#202a33;padding:6px 10px;border-radius:10px;font-size:13px;display:flex;align-items:center;gap:6px}select{cursor:pointer}.chk input[type=checkbox]{accent-color:var(--blue);width:16px;height:16px}</style><script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script><script src="https://cdn.jsdelivr.net/npm/gif.js@0.2.0/dist/gif.js"></script><div class="panel"><h2>Gossip Relay Layer</h2><div class="controls"><label class="badge">x ∈ [−5,5] <input id="xSlider"type="range"min="-5"max="5"step="0.01"value="0"style="width:190px"></label> <span class="pill">x = <span id="xRead">0.00</span></span> <label class="chk"><input type="checkbox"id="autoNet"checked="checked"> Auto</label> <label class="chk"><input type="checkbox"id="clamp"checked="checked"> Opacity clamp</label> <label class="chk"><input type="checkbox"id="showForm"checked="checked"> Formulas</label> <label class="chk"><input type="checkbox"id="showWeights"> Weights</label> <label class="chk"><input type="checkbox"id="showZ"> Show z</label></div><div class="legend"><span><span class="sw in"></span>Sources</span> <span><span class="sw hid"></span>Relays</span> <span><span class="sw out"></span>Story</span> <span><span class="sw bias"></span>Bias</span> <span><span class="sw pos"></span>w&gt;0</span> <span><span class="sw neg"></span>w&lt;0</span> <span><span class="sw w"></span>|w| thick</span></div><svg id="net"viewBox="0 0 860 400"aria-label="gossip-network"><g id="edges"></g><g id="nodes"><circle id="in0"class="node n-in"cx="140"cy="140"r="28"/><text class="label"x="140"y="140"dy="5"text-anchor="middle">x</text><circle id="in1"class="node n-in"cx="140"cy="220"r="28"/><text class="label"x="140"y="220"dy="5"text-anchor="middle">x₂</text><circle id="in2"class="node n-in"cx="140"cy="300"r="28"/><text class="label"x="140"y="300"dy="5"text-anchor="middle">x₃</text><circle id="bH"class="node n-bias"cx="440"cy="70"r="18"/><text class="tiny"x="440"y="70"dy="4"text-anchor="middle">b</text><circle id="h0"class="node n-hid"cx="440"cy="190"r="34"/><circle id="h1"class="node n-hid"cx="440"cy="290"r="34"/><text class="tiny"x="440"y="190"dy="-44"text-anchor="middle">Relay 1</text><text class="tiny"x="440"y="290"dy="-44"text-anchor="middle">Relay 2</text><circle id="out"class="node n-out"cx="740"cy="240"r="40"/><text class="tiny"x="740"y="240"dy="-54"text-anchor="middle">Story</text><text id="xin0"class="sum"x="140"y="140"dy="28"text-anchor="middle">0.00</text><text id="xin1"class="sum"x="140"y="220"dy="28"text-anchor="middle">-0.35</text><text id="xin2"class="sum"x="140"y="300"dy="28"text-anchor="middle">0.25</text><text id="hsum0"class="tiny"x="440"y="190"dy="-6"text-anchor="middle"style="display:none">z₁=0.00</text><text id="hact0"class="sum"x="440"y="190"dy="6"text-anchor="middle">h₁=0.00</text><text id="hsum1"class="tiny"x="440"y="290"dy="-6"text-anchor="middle"style="display:none">z₂=0.00</text><text id="hact1"class="sum"x="440"y="290"dy="6"text-anchor="middle">h₂=0.00</text><text id="yval"class="sum"x="740"y="240"dy="8"text-anchor="middle">y=0.00</text></g></svg><div id="formulas"class="formulas"></div><p class="caption">Unified notation: weights w₁…w₈, biases b₁,b₂, inputs x,x₂,x₃. Toggle “Weights” to show labels; “Show z” reveals pre-activations.</div><div class="panel"><h2>Activation Function</h2><div class="ax-slider-row"><span class="badge">x ∈ [−5,5]</span> <input id="axSlider"type="range"min="-5"max="5"step="0.01"value="0"> <span class="pill">x = <span id="axRead">0.00</span></span> <label class="chk"><input type="checkbox"id="autoAct"checked="checked"> Auto</label> <label class="chk"><input type="checkbox"id="clampY"checked="checked"> Clamp y</label> <select id="fn"class="select"title="Activation"><option value="relu">ReLU<option value="gelu">GELU<option value="sigmoid">Sigmoid<option value="tanh">Tanh<option value="swish">Swish</select></div><div class="readout"><div>f(x)=<b id="yRead">0.000</b></div><div id="fnName">ReLU</div><div>Range: <b id="rangeLbl">[~−1,~1]</b></div></div><div class="viz"><svg id="plot"viewBox="0 0 800 420"aria-label="activation-plot"><g id="grid"></g><path id="curve"class="curve"d=""/><line id="projx"class="projx"x1="0"y1="0"x2="0"y2="0"/><line id="projy"class="projy"x1="0"y1="0"x2="0"y2="0"/><circle id="dot"class="dot"r="6"cx="0"cy="0"/></svg></div></div><script>const fns={relu:{name:"ReLU",f:t=>Math.max(0,t)},gelu:{name:"GELU",f:t=>.5*t*(1+Math.tanh(Math.sqrt(2/Math.PI)*(t+.044715*Math.pow(t,3))))},sigmoid:{name:"Sigmoid",f:t=>1/(1+Math.exp(-t))},tanh:{name:"Tanh",f:t=>Math.tanh(t)},swish:{name:"Swish",f:t=>t/(1+Math.exp(-t))}};(()=>{const t=-.35,e=.25,n=[null,.8,-.6,-.5,.9,.3,-.4,.7,-.5],o=[null,.25,-.415];let i="relu";const a=t=>document.querySelector(t),c=a("#xSlider"),d=a("#xRead"),s=a("#autoNet"),l=a("#clamp"),u=a("#showForm"),r=a("#showWeights"),m=a("#showZ"),x=a("#formulas"),h=a("#edges"),y=a("#actSel");function w(t,e,n,o,i,a,c=!1){const d=document.createElementNS("http://www.w3.org/2000/svg","g"),s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d",function(t,e,n,o){const i=(t+n)/2,a=.07*(o-e);return`M${t},${e} C${i},${e+a} ${i},${o-a} ${n},${o}`}(t,e,n,o)),s.setAttribute("class","edge "+(c?"bias":i>=0?"pos":"neg")),c||(s.dataset.mag=function(t){const e=Math.abs(t);return e>=.65?"lg":e>=.35?"md":"sm"}(i));const l=document.createElementNS("http://www.w3.org/2000/svg","title");if(l.textContent=a+" = "+i.toFixed(3),s.appendChild(l),d.appendChild(s),r.checked){const s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("x",(t+n)/2),s.setAttribute("y",(e+o)/2-(c?8:0)),s.setAttribute("text-anchor","middle"),s.setAttribute("class","edge-label"),s.textContent=a+"="+i.toFixed(2),d.appendChild(s)}h.appendChild(d)}function g(){h.innerHTML="";const t=[{x:140,y:140},{x:140,y:220},{x:140,y:300}],e=[{x:440,y:190},{x:440,y:290}],i=440,a=70,c=740,d=240;w(t[0].x,t[0].y,e[0].x,e[0].y,n[1],"w₁"),w(t[0].x,t[0].y,e[1].x,e[1].y,n[2],"w₂"),w(t[1].x,t[1].y,e[0].x,e[0].y,n[3],"w₃"),w(t[1].x,t[1].y,e[1].x,e[1].y,n[4],"w₄"),w(t[2].x,t[2].y,e[0].x,e[0].y,n[5],"w₅"),w(t[2].x,t[2].y,e[1].x,e[1].y,n[6],"w₆"),w(i,a,e[0].x,e[0].y,o[1],"b₁",!0),w(i,a,e[1].x,e[1].y,o[2],"b₂",!0),w(e[0].x,e[0].y,c,d,n[7],"w₇"),w(e[1].x,e[1].y,c,d,n[8],"w₈")}g();const A=(t,e)=>{const n=document.getElementById(t);n&&(n.textContent=e)};function f(a){const c=ACTS[i].f,d=n[1]*a+n[3]*t+n[5]*e+o[1],s=n[2]*a+n[4]*t+n[6]*e+o[2],r=c(d),h=c(s),y=c(n[7]*r+n[8]*h);A("xin0",a.toFixed(2)),A("xin1",t.toFixed(2)),A("xin2",e.toFixed(2)),A("hact0","h₁="+r.toFixed(2)),A("hact1","h₂="+h.toFixed(2)),A("yval","y="+y.toFixed(2));[["hsum0","z₁="+d.toFixed(2)],["hsum1","z₂="+s.toFixed(2)]].forEach(([t,e])=>{const n=document.getElementById(t);m.checked?(n.style.display="",n.textContent=e):n.style.display="none"}),l.checked?[["in0",a],["in1",t],["in2",e],["h0",r],["h1",h],["out",y]].forEach(([t,e])=>{const n=document.getElementById(t);var o;n&&n.setAttribute("fill-opacity",(o=e,.25+.75*Math.min(1,Math.abs(o))).toFixed(2))}):["in0","in1","in2","h0","h1","out"].forEach(t=>document.getElementById(t).setAttribute("fill-opacity","1")),u.checked?(x.style.display="block",x.textContent=["z₁ = w₁·x + w₃·x₂ + w₅·x₃ + b₁ = "+d.toFixed(4),"z₂ = w₂·x + w₄·x₂ + w₆·x₃ + b₂ = "+s.toFixed(4),"h₁ = f(z₁) = "+r.toFixed(4),"h₂ = f(z₂) = "+h.toFixed(4),"y  = f(w₇·h₁ + w₈·h₂) = "+y.toFixed(4)+"  (f = "+ACTS[i].name+")","","Values:",`w₁=${n[1]}, w₂=${n[2]}, w₃=${n[3]}, w₄=${n[4]}, w₅=${n[5]}, w₆=${n[6]}, w₇=${n[7]}, w₈=${n[8]}`,`b₁=${o[1]}, b₂=${o[2]}`].join("\n")):x.style.display="none",window.__setActivationX&&window.__setActivationX(a,!0)}function p(t,e=!1){t=Math.max(-5,Math.min(5,t)),e||(c.value=t),d.textContent=t.toFixed(2),f(t)}c.addEventListener("input",()=>p(parseFloat(c.value))),y.addEventListener("change",()=>{i=y.value,f(parseFloat(c.value))}),[l,u,m].forEach(t=>t.addEventListener("change",()=>f(parseFloat(c.value)))),r.addEventListener("change",()=>{g(),f(parseFloat(c.value))});let b=null,F=null;function E(t){F||(F=t);p(10*((t-F)%6e3/6e3)-5,!0),s.checked&&(b=requestAnimationFrame(E))}s.addEventListener("change",()=>{s.checked?(F=null,cancelAnimationFrame(b),b=requestAnimationFrame(E)):cancelAnimationFrame(b)}),p(0),b=requestAnimationFrame(E)})(),(()=>{const t=document.getElementById("fnName"),e=document.getElementById("rangeLbl"),n=document.getElementById("axSlider"),o=document.getElementById("axRead"),i=document.getElementById("yRead"),a=(document.getElementById("autoAct"),document.getElementById("clampY")),c=document.getElementById("grid"),d=document.getElementById("curve"),s=document.getElementById("dot"),l=document.getElementById("projx"),u=document.getElementById("projy"),r=document.getElementById("actSel");let m="relu";const x=-5,h=48,y=420;let w=-1.2,g=1.2;const A=t=>h+70.4*(t-x),f=t=>y-(h+324/(g-w)*(t-w));function p(t,e,n,o,i){const a=document.createElementNS("http://www.w3.org/2000/svg","line");a.setAttribute("x1",t),a.setAttribute("y1",e),a.setAttribute("x2",n),a.setAttribute("y2",o),a.setAttribute("class",i),c.appendChild(a)}function b(t,e,n,o){const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("x",t),i.setAttribute("y",e),i.setAttribute("class","tickLbl"),i.setAttribute("text-anchor",o),i.textContent=n,c.appendChild(i)}function F(t){const e=Math.abs(t);return e>=100||0===e?t.toFixed(0):e<1e-4?t.toExponential(1):e<1?t.toFixed(2):t.toFixed(1)}function E(){const t=ACTS[m].f;!function(t){if(a.checked)return w=-1.2,g=1.2,void(e.textContent="[~−1,~1]");let n=1/0,o=-1/0;for(let e=0;e<=500;e++){const i=t(x+e/500*10);i<n&&(n=i),i>o&&(o=i)}n===o&&(n-=1,o+=1);const i=.08*(o-n);w=n-i,g=o+i,e.textContent="auto"}(t),function(){c.innerHTML="";for(let t=0;t<=10;t++){const e=h+70.4*t;p(e,h,e,372,"grid")}for(let t=0;t<=8;t++){const e=h+40.5*t;p(h,e,752,e,"grid")}p(A(0),h,A(0),372,"axis"),0>=w&&0<=g&&p(h,f(0),752,f(0),"axis");for(let t=0;t<=6;t++){const e=x+t/6*10;b(A(e),390,F(e),"middle")}for(let t=0;t<=6;t++){const e=w+t/6*(g-w);b(38,f(e)+4,F(e),"end")}}();let n="M";for(let e=0;e<=650;e++){const o=x+e/650*10,i=t(o);n+=(e?" L":"")+A(o)+","+f(i)}d.setAttribute("d",n)}function v(e=!0){if(m=r.value,t.textContent=ACTS[m].name,e){const t=parseFloat(n.value);o.textContent=t.toFixed(2);const e=document.getElementById("xSlider");e&&(e.value=t)}E();const c=parseFloat(n.value),d=ACTS[m].f(c);i.textContent=(a.checked?Math.max(Math.min(d,1e4),-1e4):d).toFixed(3);const x=A(c),h=f(d);s.setAttribute("cx",x),s.setAttribute("cy",h),l.setAttribute("x1",x),l.setAttribute("y1",f(0)),l.setAttribute("x2",x),l.setAttribute("y2",h),u.setAttribute("x1",A(0)),u.setAttribute("y1",h),u.setAttribute("x2",x),u.setAttribute("y2",h)}window.__setActivationX=t=>{n.value=t,o.textContent=parseFloat(t).toFixed(2),v(!1)},n.addEventListener("input",()=>v(!0)),a.addEventListener("change",()=>v(!1)),r.addEventListener("change",()=>v(!1));let C=null,I=null;function B(t){I||(I=t);const e=x+10*((t-I)%6e3/6e3);n.value=e,o.textContent=e.toFixed(2),v(!1);const i=document.getElementById("xSlider");i&&(i.value=e),M.checked&&(C=requestAnimationFrame(B))}const M=document.getElementById("autoAct");M.addEventListener("change",()=>{M.checked?(I=null,cancelAnimationFrame(C),C=requestAnimationFrame(B)):cancelAnimationFrame(C)}),v(),C=requestAnimationFrame(B)})()</script>
